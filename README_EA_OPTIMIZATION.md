# エリオット波動EA 最適化プロジェクト

## 📋 プロジェクト概要

このリポジトリには、エリオット波動理論に基づくMT5自動売買システム（EA）の最適化に関するドキュメントとガイドが含まれています。

**最終更新日**: 2025-11-09
**バージョン**: 1.20 (最適化版)

---

## 🎯 最適化の目的

提供されたElliottWaveEA_Optimized.mq5コードの以下の問題点を解決します:

### 主要な問題点
1. **Wave 2検証の甘さ** → 偽シグナルが多発
2. **Wave 3エントリーの早すぎ** → 確定前にエントリーしてしまう
3. **SL/TP計算の不一貫性** → 複数の計算方法が混在
4. **市場環境フィルターの不十分な統合** → エントリー直前のみチェック
5. **過剰なデバッグログ** → 本番運用時のパフォーマンス低下

---

## 📁 ドキュメント構成

### 1. [OPTIMIZATION_NOTES.md](OPTIMIZATION_NOTES.md)
**内容**: 最適化の背景と期待される効果

- 問題点の詳細分析
- 解決策の説明
- 期待される改善効果（数値付き）
- 推奨パラメータ設定
- 今後の改善案

**対象読者**: EA開発者、トレード戦略担当者

---

### 2. [CODE_IMPROVEMENTS.md](CODE_IMPROVEMENTS.md)
**内容**: 具体的なコード修正スニペット集

- ✅ **改善1**: Wave 2検証の最適化（偽シグナル30-40%削減）
- ✅ **改善2**: Wave 3エントリー条件の厳格化（勝率5-10%向上）
- ✅ **改善3**: SL計算の一本化（リスク管理の一貫性）
- ✅ **改善4**: 市場環境フィルターの早期適用
- ✅ **改善5**: デバッグログの最適化（CPU使用率10-15%削減）
- ✅ **改善6**: エントリー実行関数の簡素化

**対象読者**: コード実装担当者

**使い方**:
```mql5
// 元のコードの該当箇所を探す
// スニペットをコピー&ペースト
// コンパイル&テスト
```

---

### 3. [IMPLEMENTATION_GUIDE.md](IMPLEMENTATION_GUIDE.md)
**内容**: ステップバイステップの実装手順

**Phase 1**: Wave 2検証の厳格化（優先度★★★）
**Phase 2**: Wave 3エントリー条件の改善（優先度★★★）
**Phase 3**: SL計算の一本化（優先度★★）
**Phase 4**: 市場環境フィルターの統合（優先度★★）
**Phase 5**: デバッグログの最適化（優先度★）

各Phaseごとに:
- 手順の詳細
- テスト方法
- 評価基準
- トラブルシューティング

**対象読者**: 実装担当者、QA担当者

---

### 4. [TESTING_PLAN.md](TESTING_PLAN.md)
**内容**: 包括的なテスト計画

**Phase 1**: バックテスト（期間: 1週間）
- 基本バックテスト
- 複数通貨ペアテスト
- パラメータ最適化

**Phase 2**: デモ口座テスト（期間: 4週間）
- 基本動作確認
- 安定性検証
- ストレステスト

**Phase 3**: 少額リアル口座テスト（期間: 8週間）
- 慎重な運用
- パフォーマンス評価

**Phase 4**: 本番運用（継続）
- 段階的な資金投入
- 継続的モニタリング

**対象読者**: テスト担当者、運用責任者

---

## 🚀 クイックスタートガイド

### 前提条件
- MetaTrader 5がインストールされていること
- MQL5の基本知識があること
- バックテスト環境が整っていること

### 手順

#### Step 1: バックアップ
```bash
cp ElliottWaveEA_Optimized.mq5 ElliottWaveEA_Optimized_BACKUP_$(date +%Y%m%d).mq5
```

#### Step 2: ドキュメントを読む
1. まず`OPTIMIZATION_NOTES.md`で全体像を把握
2. `CODE_IMPROVEMENTS.md`で具体的な変更内容を確認
3. `IMPLEMENTATION_GUIDE.md`で実装手順を理解

#### Step 3: 段階的に実装
Phase 1から順に実装（一度に全部実装しない）:
```
Phase 1 → コンパイル → バックテスト → OK
Phase 2 → コンパイル → バックテスト → OK
...
```

#### Step 4: テスト
`TESTING_PLAN.md`に従って包括的にテスト

#### Step 5: デプロイ
テスト合格後、デモ口座 → 少額リアル → 本番運用へ

---

## 📊 期待される改善効果

| 項目 | 改善前 | 改善後（見込み） |
|------|--------|-----------------|
| Wave 2偽シグナル | 基準 | **30-40%削減** |
| Wave 3エントリー勝率 | 基準 | **+5-10%向上** |
| リスク管理の一貫性 | 不安定 | **安定化** |
| CPU使用率 | 基準 | **10-15%削減** |
| ログノイズ | 多い | **大幅削減** |

---

## ⚙️ 推奨パラメータ設定

### リスク管理
```
RiskPercentAligned = 0.01        // 整合時1%
RiskPercentUnaligned = 0.005     // 非整合時0.5%
RiskRewardRatio = 3.0            // リスクリワード比
```

### SL/TP設定（Micro口座）
```
MinSLDistance = 0.300            // 最小30 pips
MaxSLDistance = 0.600            // 最大60 pips
UseATRForSL = true               // ATRベースSL有効
ATRMultiplier = 1.5              // ATR乗数
ATRPeriod = 14                   // ATR期間
```

### 市場環境フィルター
```
UseMarketEnvironmentFilter = true
MinADXForTrend = 25.0            // ADX最小値
MaxATRPercentage = 2.0           // ATR最大パーセント
FilterBySessionTime = true
PreferredSessionHour = 13        // NY時間優先
```

### 動的ポジションサイジング
```
UseDynamicPositionSizing = true
BaseRiskPercentage = 0.02        // ベースリスク2%
NormalATRPercentage = 1.0        // 通常ATR 1%
MinDynamicLotSize = 0.01         // 最小ロット
MaxDynamicLotSize = 2.0          // 最大ロット
VolatilityAdjustmentFactor = 1.0 // ボラティリティ係数
```

---

## 📈 評価基準

### バックテスト合格基準
| 指標 | 目標値 | 許容範囲 |
|-----|--------|---------|
| 勝率 | 55%以上 | 50-55% |
| Profit Factor | 1.8以上 | 1.5-1.8 |
| 最大DD | 15%以下 | 15-20% |
| 総トレード数 | 50-150回 | 30-200回 |
| 平均利益/損失比 | 2.5以上 | 2.0-2.5 |

### リアル口座合格基準（8週間）
- ✅ プラス収支（+5%以上推奨）
- ✅ 最大DD 15%以内
- ✅ Profit Factor 1.5以上
- ✅ 重大なエラーなし
- ✅ 月次勝率 45%以上

---

## 🔧 トラブルシューティング

### Q1: コンパイルエラーが出る
**A**: MetaEditorのエラーメッセージを確認。括弧の不一致や構文エラーをチェック。

### Q2: SL/TP距離エラーが出る
**A**: `MinSLDistance`を0.500に増やす。ブローカーのストップレベルを確認。

### Q3: ポジションが全く開かない
**A**: Wave検出条件が厳しすぎる可能性。`MinWaveSize`を0.300に減らすか、`RequireWave3Confirmation`を一時的にfalseに。

### Q4: 過剰なトレードが発生する
**A**: `StrictWave2Validation`をtrueに。`MinEntryIntervalSeconds`を7200に増やす。

### Q5: デバッグログが多すぎる
**A**: 各関数の`debugMode`をfalseに設定。

---

## 📝 変更履歴

### v1.20 (2025-11-09) - 最適化版
- Wave 2検証ロジックの厳格化
- Wave 3エントリー条件の改善
- SL計算の一本化
- 市場環境フィルターの早期適用
- デバッグログの最適化

### v1.10 (以前のバージョン)
- 初期リリース

---

## 📚 参考資料

### エリオット波動理論
- エリオット波動の基本原則
- フィボナッチリトレースメント
- Wave 3の特性（通常最も長い）

### MT5開発
- MQL5リファレンス
- トレーディング関数
- ストラテジーテスター

---

## ⚠️ リスク警告

**重要**: このEAは教育・研究目的で提供されています。

- エリオット波動は主観的な解釈が入る手法です
- 100%の勝率は期待できません
- 必ず十分なバックテストとフォワードテストを実施してください
- 許容できる範囲内のリスクで運用してください
- 過去の成績は将来の成績を保証しません

---

## 📧 サポート

問題が発生した場合:
1. `IMPLEMENTATION_GUIDE.md`のトラブルシューティングを確認
2. ログファイルを詳細に分析
3. バックアップから復元
4. 必要に応じて専門家に相談

---

## 📄 ライセンス

Copyright 2025

---

## 🙏 謝辞

このプロジェクトは、エリオット波動理論とMT5プラットフォームに基づいています。

---

**Happy Trading! 📈**

---

最終更新: 2025-11-09
バージョン: 1.20
