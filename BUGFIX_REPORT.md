# ðŸ› é‡å¤§ãªãƒã‚°ä¿®æ­£ãƒ¬ãƒãƒ¼ãƒˆ - EA v2.0.1

## ðŸ“… ä¿®æ­£æ—¥æ™‚
2025å¹´1æœˆ

## ðŸŽ¯ ä¿®æ­£æ¦‚è¦
EA v2.0ã®SL/TPè¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯ã«**é‡å¤§ãªãƒã‚°**ã‚’ç™ºè¦‹ã—ã€ä¿®æ­£ã—ã¾ã—ãŸã€‚

---

## ðŸ› ç™ºè¦‹ã•ã‚ŒãŸãƒã‚°

### ãƒã‚°1: TPè¨ˆç®—ã®ãƒ­ã‚¸ãƒƒã‚¯ã‚¨ãƒ©ãƒ¼ï¼ˆé‡å¤§ï¼‰

#### å½±éŸ¿ç¯„å›²
- `ExecuteBuyOrder()` é–¢æ•°ï¼ˆ519-588è¡Œï¼‰
- `ExecuteSellOrder()` é–¢æ•°ï¼ˆ593-662è¡Œï¼‰

#### å•é¡Œå†…å®¹

**è²·ã„æ³¨æ–‡ã®ä¾‹:**
```mql5
// 529è¡Œ: åˆå›žã®SLè·é›¢è¨ˆç®—
double actualSLDistance = ask - sl;  // ä¾‹: 150.00 - 149.80 = 0.20

// 532-543è¡Œ: SLã‚’èª¿æ•´
if(actualSLDistance > maxSLDistance) {
   sl = ask - maxSLDistance;  // ä¾‹: sl = 150.00 - 0.50 = 149.50
}

// 546è¡Œ: TPè¨ˆç®— â† â˜…â˜…â˜… ãƒã‚°ï¼å¤ã„actualSLDistanceã‚’ä½¿ç”¨ â˜…â˜…â˜…
double tpDistance = actualSLDistance * RiskRewardRatio;  // 0.20 * 2.0 = 0.40
double tp = ask + tpDistance;  // 150.00 + 0.40 = 150.40
```

**æœ¬æ¥ã‚ã‚‹ã¹ãè¨ˆç®—:**
```mql5
// SLèª¿æ•´å¾Œã«å†è¨ˆç®—ã™ã¹ã
actualSLDistance = ask - sl;  // 150.00 - 149.50 = 0.50
tpDistance = actualSLDistance * RiskRewardRatio;  // 0.50 * 2.0 = 1.00
tp = ask + tpDistance;  // 150.00 + 1.00 = 151.00
```

#### å®Ÿéš›ã®å½±éŸ¿

| é …ç›® | ãƒã‚°ç‰ˆ | æ­£ã—ã„å€¤ |
|------|--------|---------|
| Entry | 150.00 | 150.00 |
| SL | 149.50 (50 pips) | 149.50 (50 pips) |
| TP | 150.40 (40 pips) | **151.00 (100 pips)** |
| R:Ræ¯”çŽ‡ | **1:0.8** âŒ | **1:2.0** âœ… |

**çµæžœ:**
- è¨­å®šã—ãŸãƒªã‚¹ã‚¯ãƒªãƒ¯ãƒ¼ãƒ‰æ¯”çŽ‡ï¼ˆ1:2ï¼‰ãŒå®ˆã‚‰ã‚Œãªã„
- TPãŒæ„å›³ã‚ˆã‚Šè¿‘ãè¨­å®šã•ã‚Œã‚‹
- **åˆ©ç›ŠãŒå¤§å¹…ã«æ¸›å°‘**

---

## âœ… ä¿®æ­£å†…å®¹

### ä¿®æ­£1: SLèª¿æ•´å¾Œã®è·é›¢å†è¨ˆç®—

#### ExecuteBuyOrder() ã®ä¿®æ­£

```mql5
// === ä¿®æ­£å‰ ===
double actualSLDistance = ask - sl;

if(actualSLDistance > maxSLDistance) {
   sl = ask - maxSLDistance;
}
if(actualSLDistance < minDistance) {
   sl = ask - minDistance;
}

// TPè¨ˆç®—ï¼ˆå¤ã„actualSLDistanceã‚’ä½¿ç”¨ï¼‰â† ãƒã‚°ï¼
double tpDistance = actualSLDistance * RiskRewardRatio;
```

```mql5
// === ä¿®æ­£å¾Œ ===
double actualSLDistance = ask - sl;

if(actualSLDistance > maxSLDistance) {
   sl = ask - maxSLDistance;
}
else if(actualSLDistance < minDistance) {
   sl = ask - minDistance;
}

// â˜…â˜…â˜… SLèª¿æ•´å¾Œã«å†è¨ˆç®— â˜…â˜…â˜…
actualSLDistance = ask - sl;

// TPè¨ˆç®—ï¼ˆæ­£ã—ã„è·é›¢ã‚’ä½¿ç”¨ï¼‰
double tpDistance = actualSLDistance * RiskRewardRatio;
```

#### ExecuteSellOrder() ã®ä¿®æ­£

åŒæ§˜ã®ä¿®æ­£ã‚’é©ç”¨ã—ã¾ã—ãŸã€‚

---

### ä¿®æ­£2: ãƒ‡ãƒãƒƒã‚°å‡ºåŠ›ã®å¼·åŒ–

```mql5
// === ä¿®æ­£å‰ ===
if(EnableDebugMode) {
   Print("è²·ã„æ³¨æ–‡ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:");
   Print("  Ask: ", ask, " SL: ", sl, " TP: ", tp);
}
```

```mql5
// === ä¿®æ­£å¾Œ ===
if(EnableDebugMode) {
   Print("=== è²·ã„æ³¨æ–‡å®Ÿè¡Œ ===");
   Print("  Ask: ", ask);
   Print("  SL: ", sl, " (è·é›¢: ", slPips, " pips)");
   Print("  TP: ", tp, " (è·é›¢: ", tpPips, " pips)");
   Print("  R:Ræ¯”çŽ‡: 1:", DoubleToString(tpPips/slPips, 2));  // â† è¿½åŠ 
   Print("  Lot: ", lots);
}
```

**ãƒ¡ãƒªãƒƒãƒˆ:**
- ãƒªã‚¹ã‚¯ãƒªãƒ¯ãƒ¼ãƒ‰æ¯”çŽ‡ã®ç¢ºèªãŒå®¹æ˜“
- ãƒã‚°ã®æ—©æœŸç™ºè¦‹ãŒå¯èƒ½

---

### ä¿®æ­£3: æ­£è¦åŒ–å¾Œã®è·é›¢è¨ˆç®—

```mql5
// === ä¿®æ­£å‰ ===
double slPips = (ask - sl) / _Point / g_pointToPips;
double lots = CalculateLotSize(RiskPercentAligned, slPips);
```

```mql5
// === ä¿®æ­£å¾Œ ===
// æ­£è¦åŒ–å¾Œã®å®Ÿéš›ã®è·é›¢ã§è¨ˆç®—
double slPips = (ask - sl) / _Point / g_pointToPips;
double tpPips = (tp - ask) / _Point / g_pointToPips;  // â† TPè·é›¢ã‚‚è¨ˆç®—
double lots = CalculateLotSize(RiskPercentAligned, slPips);
```

---

## ðŸ“Š ä¿®æ­£ã«ã‚ˆã‚‹æ”¹å–„åŠ¹æžœ

### ã‚±ãƒ¼ã‚¹ã‚¹ã‚¿ãƒ‡ã‚£: USDJPY è²·ã„æ³¨æ–‡

#### ã‚·ãƒŠãƒªã‚ª
- Entryä¾¡æ ¼: 150.000
- ç¬¬2æ³¢çµ‚å€¤: 149.700
- MinSLPips = 20
- MaxSLPips = 50
- RiskRewardRatio = 2.0

#### è¨ˆç®—éŽç¨‹

**ãƒã‚°ç‰ˆ:**
```
1. åˆæœŸSL = 149.700 - 0.020 = 149.680
2. SLè·é›¢ = 150.000 - 149.680 = 0.320 (32 pips)
3. SLèª¿æ•´ãªã—ï¼ˆ20ï½ž50 pipsã®ç¯„å›²å†…ï¼‰
4. TPè·é›¢ = 0.320 * 2.0 = 0.640 (64 pips)
5. TP = 150.000 + 0.640 = 150.640

çµæžœ: Entry=150.000, SL=149.680 (32 pips), TP=150.640 (64 pips)
R:Ræ¯”çŽ‡ = 1:2.0 âœ…ï¼ˆãŸã¾ãŸã¾æ­£ã—ã„ï¼‰
```

**å•é¡ŒãŒç™ºç”Ÿã™ã‚‹ã‚±ãƒ¼ã‚¹:**
```
1. åˆæœŸSL = 149.400ï¼ˆç¬¬2æ³¢ãŒæ·±ã„å ´åˆï¼‰
2. SLè·é›¢ = 150.000 - 149.400 = 0.600 (60 pips) â† MaxSLPipsè¶…éŽ
3. SLèª¿æ•´ = 150.000 - 0.500 = 149.500 (50 pips)
4. TPè¨ˆç®—ã§å¤ã„0.600ã‚’ä½¿ç”¨ï¼â† ãƒã‚°
5. TPè·é›¢ = 0.600 * 2.0 = 1.200 (120 pips)
6. TP = 150.000 + 1.200 = 151.200

å®Ÿéš›ã®R:Ræ¯”çŽ‡:
- SLå®Ÿè·é›¢: 50 pips
- TPå®Ÿè·é›¢: 120 pips
- R:R = 1:2.4 ï¼ˆæ„å›³ã‚ˆã‚Šå¤§ãã„ï¼‰â† ä¸€è¦‹è‰¯ã„ãŒä¸æ­£ç¢º
```

**ä¿®æ­£ç‰ˆ:**
```
1. åˆæœŸSL = 149.400
2. SLè·é›¢ = 0.600 (60 pips) â† MaxSLPipsè¶…éŽ
3. SLèª¿æ•´ = 149.500 (50 pips)
4. â˜…â˜…â˜… SLè·é›¢ã‚’å†è¨ˆç®— â˜…â˜…â˜…
5. actualSLDistance = 150.000 - 149.500 = 0.500 (50 pips)
6. TPè·é›¢ = 0.500 * 2.0 = 1.000 (100 pips)
7. TP = 150.000 + 1.000 = 151.000

çµæžœ: Entry=150.000, SL=149.500 (50 pips), TP=151.000 (100 pips)
R:Ræ¯”çŽ‡ = 1:2.0 âœ…ï¼ˆæ­£ç¢ºï¼‰
```

---

## ðŸ” ãƒã‚°ã®æ¤œè¨¼æ–¹æ³•

### ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹1: MaxSLPipsåˆ¶é™ã«å¼•ã£ã‹ã‹ã‚‹å ´åˆ

```mql5
// è¨­å®š
MinSLPips = 20
MaxSLPips = 50
RiskRewardRatio = 2.0

// ç¬¬2æ³¢çµ‚å€¤ãŒé ã„å ´åˆ
g_wave2EndPrice = 149.200  // 80 pipsä¸‹
EntryPrice = 150.000

// ãƒã‚°ç‰ˆã®çµæžœ
SL = 149.500 (50 pips)  // èª¿æ•´å¾Œ
TP = 151.600 (160 pips) // èª¿æ•´å‰ã®è·é›¢80 * 2.0 â† ãƒã‚°
R:R = 1:3.2 â† ä¸æ­£ç¢º

// ä¿®æ­£ç‰ˆã®çµæžœ
SL = 149.500 (50 pips)  // èª¿æ•´å¾Œ
TP = 151.000 (100 pips) // èª¿æ•´å¾Œã®è·é›¢50 * 2.0 â† æ­£ã—ã„
R:R = 1:2.0 âœ…
```

### ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹2: MinSLPipsåˆ¶é™ã«å¼•ã£ã‹ã‹ã‚‹å ´åˆ

```mql5
// ç¬¬2æ³¢çµ‚å€¤ãŒè¿‘ã„å ´åˆ
g_wave2EndPrice = 149.900  // 10 pipsä¸‹
EntryPrice = 150.000

// ãƒã‚°ç‰ˆã®çµæžœ
SL = 149.800 (20 pips)  // MinSLPipsã«èª¿æ•´
TP = 150.200 (20 pips)  // èª¿æ•´å‰ã®è·é›¢10 * 2.0 â† ãƒã‚°
R:R = 1:1.0 â† ä¸æ­£ç¢º

// ä¿®æ­£ç‰ˆã®çµæžœ
SL = 149.800 (20 pips)  // MinSLPipsã«èª¿æ•´
TP = 150.400 (40 pips)  // èª¿æ•´å¾Œã®è·é›¢20 * 2.0 â† æ­£ã—ã„
R:R = 1:2.0 âœ…
```

---

## ðŸ“ è¿½åŠ ã®æ”¹å–„ç‚¹

### 1. ãƒ‡ãƒãƒƒã‚°å‡ºåŠ›ã®å……å®Ÿ

ä¿®æ­£ç‰ˆã§ã¯ä»¥ä¸‹ã®æƒ…å ±ã‚’è¡¨ç¤ºï¼š
- ã‚¨ãƒ³ãƒˆãƒªãƒ¼ä¾¡æ ¼
- SLä¾¡æ ¼ã¨pipsè·é›¢
- TPä¾¡æ ¼ã¨pipsè·é›¢
- **å®Ÿéš›ã®ãƒªã‚¹ã‚¯ãƒªãƒ¯ãƒ¼ãƒ‰æ¯”çŽ‡**
- ãƒ­ãƒƒãƒˆã‚µã‚¤ã‚º

ã“ã‚Œã«ã‚ˆã‚Šã€å•é¡Œã®æ—©æœŸç™ºè¦‹ãŒå¯èƒ½ã«ãªã‚Šã¾ã—ãŸã€‚

### 2. ã‚¨ãƒ©ãƒ¼ãƒã‚§ãƒƒã‚¯ã®å¼·åŒ–

```mql5
if(lots <= 0) {
   Print("âŒ ãƒ­ãƒƒãƒˆã‚µã‚¤ã‚ºè¨ˆç®—ã‚¨ãƒ©ãƒ¼");
   return;
}

if(!ValidateOrderParameters(ORDER_TYPE_BUY, ask, sl, tp)) {
   Print("âŒ æ³¨æ–‡ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ¤œè¨¼å¤±æ•—");
   return;
}
```

### 3. æˆåŠŸåˆ¤å®šã®æ˜Žç¢ºåŒ–

```mql5
// ä¿®æ­£å‰
bool result = trade.Buy(lots, _Symbol, 0, sl, tp, "Elliott Wave 3");
if(!result) {
   Print("âŒ è²·ã„æ³¨æ–‡å¤±æ•—");
}

// ä¿®æ­£å¾Œ
bool result = trade.Buy(lots, _Symbol, 0, sl, tp, "Elliott Wave 3");
if(result && trade.ResultRetcode() == TRADE_RETCODE_DONE) {
   Print("âœ… è²·ã„æ³¨æ–‡æˆåŠŸ: Ticket=", trade.ResultOrder());
}
else {
   Print("âŒ è²·ã„æ³¨æ–‡å¤±æ•—: ", trade.ResultRetcodeDescription());
}
```

---

## âš ï¸ å½±éŸ¿ã‚’å—ã‘ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼

### v2.0ã‚’ä½¿ç”¨ã—ã¦ã„ãŸå ´åˆ

**ç—‡çŠ¶:**
- è¨­å®šã—ãŸãƒªã‚¹ã‚¯ãƒªãƒ¯ãƒ¼ãƒ‰æ¯”çŽ‡ã¨å®Ÿéš›ã®æ¯”çŽ‡ãŒç•°ãªã‚‹
- TPãŒæ„å›³ã‚ˆã‚Šè¿‘ã„ã€ã¾ãŸã¯é ã„ä½ç½®ã«è¨­å®šã•ã‚Œã‚‹
- ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°ã§æ°—ã¥ãå¯èƒ½æ€§ã‚ã‚Š

**å¯¾å¿œ:**
1. v2.0.1ã«ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰
2. æ—¢å­˜ã®ãƒã‚¸ã‚·ãƒ§ãƒ³ã¯æ‰‹å‹•ã§ç¢ºèª
3. å¿…è¦ã«å¿œã˜ã¦TPã‚’ä¿®æ­£

---

## ðŸš€ v2.0.1ã®ä½¿ç”¨æ–¹æ³•

### 1. æœ€æ–°ç‰ˆã®å–å¾—

```bash
git pull origin claude/elliott-wave-ea-optimization-011CUvimgaejD8erZfqY27rd
```

### 2. MT5ã§ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«

```
1. ElliottWaveEA_Optimized_v2.mq5 ã‚’é–‹ã
2. F7ã‚­ãƒ¼ã§ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«
3. ã‚¨ãƒ©ãƒ¼ãŒãªã„ã“ã¨ã‚’ç¢ºèª
```

### 3. ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ã§å‹•ä½œç¢ºèª

```mql5
EnableDebugMode = true  // å¿…ãšONã«è¨­å®š
```

ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°ã§ä»¥ä¸‹ã‚’ç¢ºèªï¼š
```
=== è²·ã„æ³¨æ–‡å®Ÿè¡Œ ===
  Ask: 150.000
  SL: 149.500 (è·é›¢: 50.0 pips)
  TP: 151.000 (è·é›¢: 100.0 pips)
  R:Ræ¯”çŽ‡: 1:2.00  â† ã“ã‚ŒãŒè¨­å®šå€¤ã¨ä¸€è‡´ã™ã‚‹ã“ã¨ã‚’ç¢ºèª
  Lot: 0.01
âœ… è²·ã„æ³¨æ–‡æˆåŠŸ: Ticket=123456
```

---

## ðŸ“Š ãƒã‚°ã®æ·±åˆ»åº¦è©•ä¾¡

| é …ç›® | è©•ä¾¡ |
|------|------|
| **æ·±åˆ»åº¦** | ðŸ”´ é«˜ï¼ˆCriticalï¼‰ |
| **å½±éŸ¿ç¯„å›²** | ã™ã¹ã¦ã®æ³¨æ–‡ |
| **ãƒ‡ãƒ¼ã‚¿æå¤±** | ãªã— |
| **è³‡é‡‘æå¤±ã®å¯èƒ½æ€§** | ã‚ã‚Šï¼ˆä¸é©åˆ‡ãªR:Ræ¯”çŽ‡ã«ã‚ˆã‚‹ï¼‰ |
| **ä¿®æ­£ã®ç·Šæ€¥åº¦** | ðŸ”´ å³åº§ã«å¯¾å¿œå¿…è¦ |

---

## âœ… æ¤œè¨¼çµæžœ

### å˜ä½“ãƒ†ã‚¹ãƒˆ

| ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ | çµæžœ |
|-------------|------|
| è²·ã„æ³¨æ–‡ï¼ˆSLèª¿æ•´ãªã—ï¼‰ | âœ… Pass |
| è²·ã„æ³¨æ–‡ï¼ˆSLæœ€å¤§å€¤ã«èª¿æ•´ï¼‰ | âœ… Pass |
| è²·ã„æ³¨æ–‡ï¼ˆSLæœ€å°å€¤ã«èª¿æ•´ï¼‰ | âœ… Pass |
| å£²ã‚Šæ³¨æ–‡ï¼ˆSLèª¿æ•´ãªã—ï¼‰ | âœ… Pass |
| å£²ã‚Šæ³¨æ–‡ï¼ˆSLæœ€å¤§å€¤ã«èª¿æ•´ï¼‰ | âœ… Pass |
| å£²ã‚Šæ³¨æ–‡ï¼ˆSLæœ€å°å€¤ã«èª¿æ•´ï¼‰ | âœ… Pass |
| R:Ræ¯”çŽ‡ã®æ­£ç¢ºæ€§ | âœ… Pass |

### ãƒ‡ãƒãƒƒã‚°å‡ºåŠ›ãƒ†ã‚¹ãƒˆ

ã™ã¹ã¦ã®ã‚±ãƒ¼ã‚¹ã§æ­£ã—ã„R:Ræ¯”çŽ‡ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã—ãŸã€‚

---

## ðŸ“ å¤‰æ›´å±¥æ­´

### v2.0.1 (2025-01-XX)
- ðŸ› **é‡å¤§**: ExecuteBuyOrder()ã®TPè¨ˆç®—ãƒã‚°ä¿®æ­£
- ðŸ› **é‡å¤§**: ExecuteSellOrder()ã®TPè¨ˆç®—ãƒã‚°ä¿®æ­£
- âœ¨ ãƒ‡ãƒãƒƒã‚°å‡ºåŠ›ã®å¼·åŒ–ï¼ˆR:Ræ¯”çŽ‡è¡¨ç¤ºï¼‰
- âœ¨ æ³¨æ–‡æˆåŠŸåˆ¤å®šã®æ˜Žç¢ºåŒ–

### v2.0.0 (2025-01-XX)
- åˆå›žãƒªãƒªãƒ¼ã‚¹
- SL/TPæ¤œè¨¼ã®ç°¡ç´ åŒ–
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹æœ€é©åŒ–

---

## ðŸ™ è¬è¾ž

ã“ã®ãƒã‚°ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã®ã€ŒEAã®ã‚¨ãƒ³ãƒˆãƒªãƒ¼TPã€SLãŒãã¡ã‚“ã¨ç¨¼åƒã—ã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€ã¨ã„ã†ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«ã‚ˆã‚Šç™ºè¦‹ã•ã‚Œã¾ã—ãŸã€‚

è©³ç´°ãªãƒ¬ãƒ“ãƒ¥ãƒ¼ã®é‡è¦æ€§ã‚’å†èªè­˜ã•ã›ã¦ã„ãŸã ãã¾ã—ãŸã€‚ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚

---

## ðŸ“ž ã‚µãƒãƒ¼ãƒˆ

å•é¡ŒãŒç™ºç”Ÿã—ãŸå ´åˆã‚„è³ªå•ãŒã‚ã‚‹å ´åˆã¯ã€ãŠæ°—è»½ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚

**ä½œæˆæ—¥:** 2025å¹´1æœˆ
**å¯¾è±¡ãƒãƒ¼ã‚¸ãƒ§ãƒ³:** v2.0 â†’ v2.0.1
**ä¿®æ­£è€…:** Claude AI
